<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <title>dresden by CERN Security Team</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>dresden</h1>
        <h2>dresden is a kernel module that will log emergency messages for every attempt of inserting or removing a kernel module.
Also, it will block the insertion of every kernel module, by replacing the init functio of the (wannabe) incoming module
with a function crafted for failure. After deploying dresden, you will not be able to remove it. It will delete itself from
the list of the loaded kernel modules.
        </h2>

        <section id="downloads">
          <a href="./" class="btn">Download SLC 5 source rpm</a>
          <a href="./" class="btn">Download SLC 6 source rpm</a>
          </section>
        </br>
        <section id="downloads">          
          <a href="https://github.com/cern-cert/dresden" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h3>Description</h3>

<p>
dresden is a kernel module that will log emergency messages for every attempt of inserting or removing a kernel module.
Also, it will block the insertion of every kernel module, by replacing the init functio of the (wannabe) incoming module
with a function crafted for failure. After deploying dresden, you will not be able to remove it. It will delete itself from
the list of the loaded kernel modules.
</p>

<h3>How to deploy</h3>

<pre><code>
sudo yum install rpm-build redhat-rpm-config kernel-devel gcc
cd /tmp/
git init
git pull https://github.com/CERN-CERT/netlog
rpmbuild --rebuild netlog-*.slc6.src.rpm
sudo rpm -i ~/rpmbuild/RPMS/x86_64/kmod-netlog-*.rpm
sudo depmod -a  
sudo modprobe netlog
</code></pre>

<h3>Supported kernel versions</h3>

<p>2.6.12 up to 3.3.8</p>

<h3>Format of the log messages</h3>

<p>Insertion</p>

<pre><code>l  9 13:36:05 kmod-testing kernel: dresden: Kernel module insertion blocker and action notifier by CERN Security Team
Jul  9 13:36:05 kmod-testing kernel: dresden:   [+] Future loading of kernel modules will be prevented
Jul  9 13:36:05 kmod-testing kernel: dresden:  [+] Emergency messages will be logged in case of trying to load or unload a module
Jul  9 13:36:05 kmod-testing kernel: dresden:	[+] You are not able to remove this module
</pre></code>

<p>Trying to insert a module</p>

<pre><code>
[root@kmod-testing netlog]# insmod ./netlog.ko

Message from syslogd@kmod-testing at Jul  9 13:36:52 ...
 kernel:dresden: event: MODULE_STATE_COMING name: netlog init: 0xffffffffa0038000 size of init (text + data)  											0x137e core: 0xffffffffa07c7000 size of core (text + data) 0x20037a8

Message from syslogd@kmod-testing at Jul  9 13:36:52 ...
 kernel:dresden: New module is th name netlog. Its functionality will be disabled

Message from syslogd@kmod-testing at Jul  9 13:36:52 ...
 kernel:dresden: event: MODULE_STATE_GOING name: netlog core: 0xffffffffa07c7000 size of core (text + data) 0x20037a8
insmod: error inserting './netlog.ko': -1 Operation not permitted
[root@kmod-testing netlog]# 

Jul  9 13:36:52 kmod-testing kernel: dresden: event: MODULE_STATE_COMING name: netlog init: 0xffffffffa0038000 size of init (text + data)  							0x137e core: 0xffffffffa07c7000 size of core (text + data) 0x20037a8
Jul  9 13:36:52 kmod-testing kernel: dresden: New module is th name netlog. Its functionality will be disabled
Jul  9 13:36:52 kmod-testing kernel: Module insertion blocked by CERN's dresden
Jul  9 13:36:52 kmod-testing kernel: dresden: event: MODULE_STATE_GOING name: netlog core: 0xffffffffa07c7000 size of core (text + data) 0x20037a8</pre></code>

  
</pre></code>

<h3>Support or Contact</h3>

<p>
<a href="mailto:cert@cern.ch?Subject=dresden%20support/contact">CERN CERT</a>
</p>
      </section>
    </div>
    
  </body>
</html>
