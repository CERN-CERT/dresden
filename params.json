{"tagline":"Block incoming modules and log emergency alerts in case of trying to insert a new module or removing an existing one","google":"","note":"Don't delete this file! It's used internally to help with page regeneration.","body":"  \t\t\t\t\t+----------------------------+\r\n\t\t\t\t\t+           dresden          +        \r\n\t\t\t\t\t+----------------------------+\r\n\r\nProduct name: \t\t\t\tdresden\r\nDate:\t\t\t\t        Jul 9 2012\r\nVersion:\t\t\t      \t1.0\r\nVendor:\t\t\t\t      \tCERN\r\nAuthor:\t\t\t\t      \tPanos Sakkos while at Computer Security Team \r\nCST Email:\t\t\t    \tcert-sec@cern.ch\r\nAuthor Email:\t\t\t  \t<panos.sakkos@cern.ch> \r\nLicense: \t\t\t      \tGPLv3\r\n\r\n\t\t\t\t\t+-------+\r\n\t\t\t\t\t|License|\r\n\t\t\t\t\t+-------+\r\n\r\nCopyright 2011 CERN. This software is distributed under the terms of the GNU General Public\r\nLicence version 3 (GPL Version 3), copied verbatim in the file COPYING. In applying this licence,\r\nCERN does not waive the privileges and immunities granted to it by virtue of its status as an \r\nIntergovernmental Organization or submit itself to any jurisdiction.\r\n\r\n\r\n\t\t\t\t\t+-----------+\r\n\t\t\t\t\t|Description|\r\n\t\t\t\t\t+-----------+\r\n\t\t\t\t\t\r\ndresden is a kernel module that will log emergency messages for every attempt of inserting or removing a kernel module.\r\nAlso, it will block the insertion of every kernel module, by replacing the init functio of the (wannabe) incoming module\r\nwith a function crafted for failure. After deploying dresden, you will not be able to remove it. It will delete itself from\r\nthe list of the loaded kernel modules.\r\n\r\n\t\t\t\t\t+--------------------------+\r\n\t\t\t\t\t|Supported kernel versions |\r\n\t\t\t\t\t+--------------------------+\r\n          \r\n2.6.12 up to 3.3.8\r\n\r\n\t\t\t\t\t+--------------------------+\r\n\t\t\t\t\t|Format of the log messages|\r\n\t\t\t\t\t+--------------------------+\r\n\r\nJul  9 13:36:05 kmod-testing kernel: dresden: Kernel module insertion blocker and action notifier by CERN Security Team\r\nJul  9 13:36:05 kmod-testing kernel: dresden:   [+] Future loading of kernel modules will be prevented\r\nJul  9 13:36:05 kmod-testing kernel: dresden:\t[+] Emergency messages will be logged in case of trying to load or unload a module\r\nJul  9 13:36:05 kmod-testing kernel: dresden:\t[+] You are not able to remove this module\r\n\r\nTrying to insert a module:\r\n\r\n[root@kmod-testing netlog]# insmod ./netlog.ko\r\n\r\nMessage from syslogd@kmod-testing at Jul  9 13:36:52 ...\r\n kernel:dresden: event: MODULE_STATE_COMING name: netlog init: 0xffffffffa0038000 size of init (text + data)  \t\t\t\t\t\t\t\t\t\t\t0x137e core: 0xffffffffa07c7000 size of core (text + data) 0x20037a8\r\n\r\nMessage from syslogd@kmod-testing at Jul  9 13:36:52 ...\r\n kernel:dresden: New module is th name netlog. Its functionality will be disabled\r\n\r\nMessage from syslogd@kmod-testing at Jul  9 13:36:52 ...\r\n kernel:dresden: event: MODULE_STATE_GOING name: netlog core: 0xffffffffa07c7000 size of core (text + data) 0x20037a8\r\ninsmod: error inserting './netlog.ko': -1 Operation not permitted\r\n[root@kmod-testing netlog]# \r\n\r\nJul  9 13:36:52 kmod-testing kernel: dresden: event: MODULE_STATE_COMING name: netlog init: 0xffffffffa0038000 size of init (text + data)  \t\t\t\t\t\t\t0x137e core: 0xffffffffa07c7000 size of core (text + data) 0x20037a8\r\nJul  9 13:36:52 kmod-testing kernel: dresden: New module is th name netlog. Its functionality will be disabled\r\nJul  9 13:36:52 kmod-testing kernel: Module insertion blocked by CERN's dresden\r\nJul  9 13:36:52 kmod-testing kernel: dresden: event: MODULE_STATE_GOING name: netlog core: 0xffffffffa07c7000 size of core (text + data) 0x20037a8\r\n\r\n\t\t\t\t\t+--------------+\r\n\t\t\t\t\t|How to compile|\r\n\t\t\t\t\t+--------------+\r\n\r\nIn the source directory run:\r\n\r\n\tmake build\r\n\r\nThen run:\r\n\r\n\tinsmod ./dresden.ko\r\n\r\nin order to insert the module in the kernel.\r\nAnd in order to remove it, run:\r\n\r\n\trmmod dresden\r\n\r\n\r\n\t\t\t\t\t+----------+\r\n\t\t\t\t\t|References|\r\n\t\t\t\t\t+----------+\r\n\r\nLinux Source Code:\r\n\thttp://www.kernel.org/\r\n\r\nScientific Linux CERN\r\n\thttp://linux.web.cern.ch/linux/\r\n\r\nHarry Dresden:\r\n  http://en.wikipedia.org/wiki/Harry_Dresden\r\n","name":"Dresden"}